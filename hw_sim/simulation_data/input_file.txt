#slide 41
units real

#slide 42
boundary p p p

#slide 43
atom_style full
bond_style harmonic
angle_style charmm
dihedral_style charmm
improper_style harmonic
special_bonds charmm
pair_style lj/charmm/coul/long 10 12
pair_modify mix arithmetic
kspace_style pppm 0.0001
neigh_modify delay 1 every 1 check yes

#slide 51
#read data-file:
read_data solvate.data
#make folder for the results:
variable results string "simulation_results"
variable el_results string "simulation_results_el"
shell mkdir ${results}
shell cd ${results}

#slide 52
thermo_style custom step temp press lx ke pe etotal density
thermo          100
#energy minimisation:
minimize 0.0 0.0 1000 10000
velocity all create 300.0 1234567 mom yes rot yes dist gaussian
#equilibration at NVT:
fix 1 all nvt temp 300.0 300.0 100 
timestep 0.001
run 2000
unfix 1
#equilibration at NpT:
fix 1 all npt temp 300.0 300.0 100 iso 1.0 1.0 1000 
run 5000
unfix 1

#initialization for md
reset_timestep 0
fix main_fix all npt temp 300.0 300.0 100 iso 1.0 1.0 1000
group hydrogens type 1
group oxygens type 2
#md without electrical field:
#                           O-O H-O
compute get_rdf all rdf 100 2 2 1 2
compute get_msd_ox oxygens msd com yes
compute get_vacf all vacf

fix rdf_output all ave/time 100 40 4000 c_get_rdf[*] ave running file RDF.txt mode vector
fix msd_output all print 100 "$(step) $(c_get_msd_ox[4])" file MSD.txt
fix vacf_output all print 1 "$(step) $(c_get_vacf[4])" file VACF.txt screen no
fix verbose all print 100 "$(step) $(temp) $(density)" file T_and_rho.txt screen no

dump data_dump all custom 10 dump.*.txt mol type x y z xu yu zu vx vy vz
dump_modify data_dump sort id

run 10000


#md with electrical field:
shell cd ..
shell mkdir ${el_results}
shell cd ${el_results}
fix f_electr all efield 0.0 0.0 0.05
compute get_vacf_el all vacf

fix vacf_output all print 1 "$(step) $(c_get_vacf_el[4])" file VACF_el.txt screen no

dump data_dump_el all custom 10 dump_el.*.txt mol type x y z xu yu zu vx vy vz
dump_modify data_dump_el sort id

run 10000